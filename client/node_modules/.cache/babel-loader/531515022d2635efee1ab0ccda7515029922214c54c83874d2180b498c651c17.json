{"ast":null,"code":"import React,{useEffect,useState}from'react';import'./post.css';import{profile,dropdown,upvote_highlight,downvote_highlight,downvote_none,upvote_none}from'./imports';import study from'../../assets/images/study.jpg';import{Link}from'react-router-dom';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function formatDate(date){return new Date(date).toLocaleDateString(\"en-US\",{year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit',second:'2-digit'});}const Post=_ref=>{let{user,contents}=_ref;const user_id=contents.user_id;const post_id=contents._id;const title=contents.title;const content=contents.content;const date=formatDate(contents.entryDate);const course_ids=contents.course_id;const username=contents.user_id.username;const profile_image=contents.user_id.profile_img;const type=contents.type;const topic_ids=contents.topic_ids;const[upvote,setUpvote]=useState([]);const[downvote,setDownvote]=useState([]);const fetchVotes=()=>{axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/vote/\").concat(post_id)).then(res=>{const{upvote,downvote}=res.data;setUpvote(upvote);setDownvote(downvote);}).catch(err=>console.log(err));};useEffect(()=>{fetchVotes();},[post_id]);const query_tags=topic_ids.map((content,index)=>/*#__PURE__*/_jsx(Link,{to:'/topics/'+content.name,children:'#'+content.name},index));const vote=like_type=>{const formData={postId:post_id,userId:user._id,voteType:like_type};//console.log(formData);\naxios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/vote\"),formData).then(res=>{//console.log(res.data);\nfetchVotes();//refresh\n}).catch(err=>console.log(err));};const handleUpvote=()=>vote(1);const handleDownvote=()=>vote(-1);return/*#__PURE__*/_jsxs(\"div\",{className:\"post__container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post__header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post__footer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"post__footer-tags\",children:query_tags}),/*#__PURE__*/_jsxs(Link,{className:\"post__footer-view\",to:'/posts/'+post_id,children:[/*#__PURE__*/_jsx(\"img\",{src:dropdown}),/*#__PURE__*/_jsx(\"p\",{children:\"View more\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"post__footer-date\",children:/*#__PURE__*/_jsx(\"p\",{children:date})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post__profile\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"post__profile-image\",children:/*#__PURE__*/_jsx(\"img\",{src:profile_image,alt:\"profile\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"post__profile-name\",children:/*#__PURE__*/_jsx(Link,{to:'/profile/'+username,children:username})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post__location\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Posted in \"}),/*#__PURE__*/_jsxs(Link,{to:'/courses/'+course_ids.name,children:[\"c/\",course_ids.name]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post__votes\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"post__votes-upvote\",onClick:user&&handleUpvote,children:/*#__PURE__*/_jsx(\"img\",{src:upvote_none,alt:\"upvote\"})}),/*#__PURE__*/_jsx(\"p\",{children:upvote}),/*#__PURE__*/_jsx(\"button\",{className:\"post__votes-downvote\",onClick:user&&handleDownvote,children:/*#__PURE__*/_jsx(\"img\",{src:downvote_none,alt:\"downvote\"})}),/*#__PURE__*/_jsx(\"p\",{children:downvote})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"post__content\",children:/*#__PURE__*/_jsx(\"p\",{children:content})})]});};export default Post;","map":{"version":3,"names":["React","useEffect","useState","profile","dropdown","upvote_highlight","downvote_highlight","downvote_none","upvote_none","study","Link","axios","jsx","_jsx","jsxs","_jsxs","formatDate","date","Date","toLocaleDateString","year","month","day","hour","minute","second","Post","_ref","user","contents","user_id","post_id","_id","title","content","entryDate","course_ids","course_id","username","profile_image","profile_img","type","topic_ids","upvote","setUpvote","downvote","setDownvote","fetchVotes","get","concat","process","env","REACT_APP_API_URL","then","res","data","catch","err","console","log","query_tags","map","index","to","name","children","vote","like_type","formData","postId","userId","voteType","post","handleUpvote","handleDownvote","className","src","alt","onClick"],"sources":["C:/Users/minem/OneDrive/Documents/GitHub/Taft-Overflow/client/src/components/post/Post.jsx"],"sourcesContent":["import React, { useEffect, useState }  from 'react'\r\nimport './post.css';\r\nimport {profile,dropdown, upvote_highlight,downvote_highlight,downvote_none,upvote_none} from './imports';\r\nimport study from '../../assets/images/study.jpg';\r\nimport {Link} from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nfunction formatDate(date) {\r\n  return new Date(date).toLocaleDateString(\"en-US\", {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    second: '2-digit'\r\n  });\r\n}\r\n\r\n\r\n\r\nconst Post = ({user,contents}) => {\r\n  const user_id = contents.user_id;\r\n  const post_id = contents._id;\r\n  const title = contents.title;\r\n  const content = contents.content;\r\n  const date = formatDate(contents.entryDate);\r\n  const course_ids = contents.course_id;\r\n  const username = contents.user_id.username;\r\n  const profile_image = contents.user_id.profile_img;\r\n  const type = contents.type;\r\n  const topic_ids = contents.topic_ids;\r\n\r\n  const [upvote,setUpvote] = useState([])\r\n  const [downvote,setDownvote] = useState([])\r\n\r\n\r\n  const fetchVotes = () => {\r\n    axios.get(`${process.env.REACT_APP_API_URL}/api/vote/${post_id}`)\r\n      .then(res => {\r\n        const { upvote, downvote } = res.data;\r\n        setUpvote(upvote);\r\n        setDownvote(downvote);\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchVotes();\r\n  }, [post_id]);\r\n\r\n\r\n  const query_tags = topic_ids.map((content, index) => \r\n    <Link key={index} to={'/topics/'+content.name}>{'#'+content.name}</Link>\r\n  );\r\n  \r\n  const vote = (like_type) => {\r\n    const formData = {\r\n      postId: post_id,\r\n      userId: user._id,\r\n      voteType: like_type\r\n    };\r\n    //console.log(formData);\r\n    axios.post(`${process.env.REACT_APP_API_URL}/api/vote`, formData)\r\n      .then(res => {\r\n        //console.log(res.data);\r\n        fetchVotes(); //refresh\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n  \r\n  const handleUpvote = () => vote(1);\r\n  const handleDownvote = () => vote(-1);\r\n\r\n\r\n  return (\r\n    <div className='post__container'>\r\n      <div className='post__header'>\r\n        <div className='post__footer'>\r\n          <div className='post__footer-tags'>\r\n            {query_tags}\r\n          </div>\r\n          <Link className='post__footer-view' to={'/posts/'+ post_id}>\r\n            <img src={dropdown}></img>\r\n            <p>View more</p>\r\n          </Link>\r\n          <div className='post__footer-date'>\r\n            <p>{date}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className='post__profile'>\r\n          <div className='post__profile-image'>\r\n            <img src={profile_image} alt='profile'/>\r\n          </div>\r\n          <div className='post__profile-name'>\r\n            <Link to={'/profile/'+username}>{username}</Link>\r\n          </div>\r\n        </div>\r\n        <div className='post__location'>\r\n          <p>Posted in </p>\r\n          <Link to={'/courses/'+ course_ids.name}>c/{course_ids.name}</Link>\r\n        </div>\r\n        <div className='post__votes'>\r\n          <button className='post__votes-upvote' onClick={user && handleUpvote}><img src={upvote_none} alt='upvote'></img></button>\r\n          <p>{upvote}</p>\r\n          <button className='post__votes-downvote' onClick={user && handleDownvote}><img src={downvote_none} alt='downvote'></img></button>\r\n          <p>{downvote}</p>\r\n        </div>\r\n      </div>\r\n      <div className='post__content'>\r\n        <p>{content}</p>\r\n      </div>\r\n    </div>\r\n\r\n    \r\n  )\r\n}\r\n\r\nexport default Post"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}