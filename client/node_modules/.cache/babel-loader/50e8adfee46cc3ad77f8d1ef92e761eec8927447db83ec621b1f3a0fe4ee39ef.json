{"ast":null,"code":"import React,{useEffect,useState}from'react';import'draft-js/dist/Draft.css';import'./create_post.css';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Create_post=_ref=>{let{user}=_ref;const[courses,setCourses]=useState([]);const[isAdmin,setAdmin]=useState(false);// const [user, setUser] = useState(null);\n// useEffect(() => {\n//     axios.get('${process.env.REACT_APP_API_URL}/api/current_user')\n//       .then(response => {\n//         const { username, _id } = response.data;\n//         setUser({ username, _id }); \n//       })\n//       .catch(error => {\n//         console.error('Error fetching user:', error);\n//       });\n// }, []);\nuseEffect(()=>{if(user){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/courses/user/\").concat(user.username)).then(res=>setCourses(res.data)).catch(err=>console.log(err));}if(user.username==='admin'){setAdmin(true);}},[user]);const Courses=courses.map((content,index)=>/*#__PURE__*/_jsx(\"option\",{value:content.course_name,children:'c/'+content.course_name},index));const resetForm=()=>{document.getElementById('title').value='';document.getElementById('course').value='';document.getElementById('content').value='';document.getElementById('topics').value='';};const handleSubmit=e=>{e.preventDefault();// Prevent default form submission\nconst title=document.getElementById('title').value;const course=document.getElementById('course').value;const content=document.getElementById('content').value;const topics=document.getElementById('topics').value;//const type = document.getElementById('type').value;\nconst topicsArray=topics.split(' ').map(topic=>topic.replace(/^#/,''));let type='regular';if(isAdmin){type=document.getElementById('type').value;}const formData={title,course,content,topicsArray,username:String(user.username),type};axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/posts\"),formData).then(response=>{// Handle success\nconsole.log(response.data);alert(\"Post created successfully!\");window.location.href=\"/\";}).catch(error=>{// Handle error\nconsole.log(error);});console.log(formData);resetForm();};return/*#__PURE__*/_jsxs(\"div\",{className:\"create-post-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-title\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"create-post-header\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{id:\"title\",type:\"text\",className:\"title-input\",placeholder:\"Input Title Here\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-course\",children:[isAdmin&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"create-post-header-type\",children:\"Type\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"type\",className:\"course-select\",placeholder:\"Type\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,selected:true,hidden:true,children:\"Choose a type...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"announcement\",children:\"Announcement\"}),/*#__PURE__*/_jsx(\"option\",{value:\"regular\",children:\"Regular Post\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"create-post-header-type\",children:\"Course\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"course\",className:\"course-select\",placeholder:\"Course\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,selected:true,hidden:true,children:\"Choose a Course...\"}),Courses]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-column\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"create-post-topic\",children:\"Content:\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"content\",className:\"text-input\",placeholder:\"Write a something...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"create-post-topic\",children:\"Enter topics in the format [#topic] Example:\\\"#dlsu #id120\\\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"topic-input-container\",children:/*#__PURE__*/_jsx(\"input\",{id:\"topics\",type:\"text\",className:\"topic-input\",placeholder:\"Input Topics Here\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"post-button\",children:\"Post\"})]})]});};export default Create_post;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Create_post","_ref","user","courses","setCourses","isAdmin","setAdmin","get","concat","process","env","REACT_APP_API_URL","username","then","res","data","catch","err","console","log","Courses","map","content","index","value","course_name","children","resetForm","document","getElementById","handleSubmit","e","preventDefault","title","course","topics","topicsArray","split","topic","replace","type","formData","String","post","response","alert","window","location","href","error","className","id","placeholder","disabled","selected","hidden","onClick"],"sources":["C:/Users/minem/OneDrive/Documents/GitHub/Taft-Overflow/client/src/components/create_post/Create_post.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport 'draft-js/dist/Draft.css';\r\nimport './create_post.css';\r\nimport axios from 'axios';\r\n\r\nconst Create_post = ({user}) => {\r\n    const [courses, setCourses] = useState([]);\r\n    const [isAdmin,setAdmin]=useState(false);\r\n    // const [user, setUser] = useState(null);\r\n\r\n    // useEffect(() => {\r\n    //     axios.get('${process.env.REACT_APP_API_URL}/api/current_user')\r\n    //       .then(response => {\r\n    //         const { username, _id } = response.data;\r\n    //         setUser({ username, _id }); \r\n    //       })\r\n    //       .catch(error => {\r\n    //         console.error('Error fetching user:', error);\r\n    //       });\r\n    // }, []);\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            axios.get(`${process.env.REACT_APP_API_URL}/api/courses/user/${user.username}`)\r\n              .then(res => setCourses(res.data))\r\n              .catch(err => console.log(err));\r\n        }\r\n\r\n        if(user.username === 'admin'){\r\n            setAdmin(true);\r\n        }\r\n    }, [user]);\r\n      \r\n    const Courses = courses.map((content, index) => \r\n        <option key={index} value={content.course_name}>{'c/'+content.course_name}</option>\r\n    );\r\n\r\n    const resetForm = () => {\r\n        document.getElementById('title').value = '';\r\n        document.getElementById('course').value= '';\r\n        document.getElementById('content').value= '';\r\n        document.getElementById('topics').value= '';\r\n    };\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault(); // Prevent default form submission\r\n        const title = document.getElementById('title').value;\r\n        const course = document.getElementById('course').value;\r\n        const content = document.getElementById('content').value;\r\n        const topics = document.getElementById('topics').value;\r\n        //const type = document.getElementById('type').value;\r\n        const topicsArray = topics.split(' ').map(topic => topic.replace(/^#/, ''));\r\n        let type = 'regular';\r\n\r\n        if(isAdmin){\r\n            type = document.getElementById('type').value;\r\n        }\r\n        \r\n        const formData = {\r\n            title,\r\n            course,\r\n            content,\r\n            topicsArray,\r\n            username: String(user.username),\r\n            type\r\n        };\r\n        \r\n        axios.post(`${process.env.REACT_APP_API_URL}/api/posts`, formData)\r\n            .then(response => {\r\n                // Handle success\r\n                console.log(response.data);\r\n                alert(\"Post created successfully!\");\r\n                window.location.href = \"/\";\r\n            })\r\n            .catch(error => {\r\n                // Handle error\r\n                console.log(error);\r\n            });\r\n            \r\n        console.log(formData);\r\n        resetForm();\r\n    };\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n\r\n        <div className=\"create-post-container\">\r\n                <div className='form-group-row'>\r\n        \r\n                    <div className=\"form-group-title\">\r\n                        <p className='create-post-header'>Title</p>\r\n                        <input id='title' type=\"text\" className=\"title-input\" placeholder=\"Input Title Here\" />\r\n                    </div>\r\n                    <div className=\"form-group-course\">\r\n                        \r\n                        {isAdmin &&(\r\n                            <div>\r\n                        <p className='create-post-header-type'>Type</p>\r\n                        <select id='type' className=\"course-select\" placeholder='Type'>\r\n                            <option value=\"\" disabled selected hidden>Choose a type...</option>\r\n                            <option value=\"announcement\">Announcement</option>\r\n                            <option value=\"regular\">Regular Post</option>\r\n                        </select>\r\n                        </div>\r\n                        )\r\n                        }\r\n                    <div>\r\n                        <p className='create-post-header-type'>Course</p>\r\n                        <select id='course' className=\"course-select\" placeholder='Course'>\r\n                            <option value=\"\" disabled selected hidden>Choose a Course...</option>\r\n                            {Courses}\r\n                        </select></div>\r\n                    </div>\r\n                </div>\r\n            <div className='form-group-column'>\r\n                <p className='create-post-topic'>Content:</p>\r\n                <textarea id='content' className=\"text-input\" placeholder=\"Write a something...\" />\r\n\r\n                <p className='create-post-topic'>Enter topics in the format [#topic] Example:\"#dlsu #id120\"</p>\r\n                <div className=\"topic-input-container\">\r\n                    <input id='topics' type=\"text\" className=\"topic-input\" placeholder=\"Input Topics Here\" />\r\n                </div>\r\n                <button onClick={handleSubmit} className=\"post-button\">Post</button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Create_post;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,yBAAyB,CAChC,MAAO,mBAAmB,CAC1B,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE1B,KAAM,CAAAC,WAAW,CAAGC,IAAA,EAAY,IAAX,CAACC,IAAI,CAAC,CAAAD,IAAA,CACvB,KAAM,CAACE,OAAO,CAAEC,UAAU,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACW,OAAO,CAACC,QAAQ,CAAC,CAACZ,QAAQ,CAAC,KAAK,CAAC,CACxC;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEAD,SAAS,CAAC,IAAM,CACZ,GAAIS,IAAI,CAAE,CACNP,KAAK,CAACY,GAAG,IAAAC,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,uBAAAH,MAAA,CAAqBN,IAAI,CAACU,QAAQ,CAAE,CAAC,CAC5EC,IAAI,CAACC,GAAG,EAAIV,UAAU,CAACU,GAAG,CAACC,IAAI,CAAC,CAAC,CACjCC,KAAK,CAACC,GAAG,EAAIC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAAC,CACrC,CAEA,GAAGf,IAAI,CAACU,QAAQ,GAAK,OAAO,CAAC,CACzBN,QAAQ,CAAC,IAAI,CAAC,CAClB,CACJ,CAAC,CAAE,CAACJ,IAAI,CAAC,CAAC,CAEV,KAAM,CAAAkB,OAAO,CAAGjB,OAAO,CAACkB,GAAG,CAAC,CAACC,OAAO,CAAEC,KAAK,gBACvC1B,IAAA,WAAoB2B,KAAK,CAAEF,OAAO,CAACG,WAAY,CAAAC,QAAA,CAAE,IAAI,CAACJ,OAAO,CAACG,WAAW,EAA5DF,KAAqE,CACtF,CAAC,CAED,KAAM,CAAAI,SAAS,CAAGA,CAAA,GAAM,CACpBC,QAAQ,CAACC,cAAc,CAAC,OAAO,CAAC,CAACL,KAAK,CAAG,EAAE,CAC3CI,QAAQ,CAACC,cAAc,CAAC,QAAQ,CAAC,CAACL,KAAK,CAAE,EAAE,CAC3CI,QAAQ,CAACC,cAAc,CAAC,SAAS,CAAC,CAACL,KAAK,CAAE,EAAE,CAC5CI,QAAQ,CAACC,cAAc,CAAC,QAAQ,CAAC,CAACL,KAAK,CAAE,EAAE,CAC/C,CAAC,CAED,KAAM,CAAAM,YAAY,CAAIC,CAAC,EAAK,CACxBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAAE;AACpB,KAAM,CAAAC,KAAK,CAAGL,QAAQ,CAACC,cAAc,CAAC,OAAO,CAAC,CAACL,KAAK,CACpD,KAAM,CAAAU,MAAM,CAAGN,QAAQ,CAACC,cAAc,CAAC,QAAQ,CAAC,CAACL,KAAK,CACtD,KAAM,CAAAF,OAAO,CAAGM,QAAQ,CAACC,cAAc,CAAC,SAAS,CAAC,CAACL,KAAK,CACxD,KAAM,CAAAW,MAAM,CAAGP,QAAQ,CAACC,cAAc,CAAC,QAAQ,CAAC,CAACL,KAAK,CACtD;AACA,KAAM,CAAAY,WAAW,CAAGD,MAAM,CAACE,KAAK,CAAC,GAAG,CAAC,CAAChB,GAAG,CAACiB,KAAK,EAAIA,KAAK,CAACC,OAAO,CAAC,IAAI,CAAE,EAAE,CAAC,CAAC,CAC3E,GAAI,CAAAC,IAAI,CAAG,SAAS,CAEpB,GAAGnC,OAAO,CAAC,CACPmC,IAAI,CAAGZ,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAC,CAACL,KAAK,CAChD,CAEA,KAAM,CAAAiB,QAAQ,CAAG,CACbR,KAAK,CACLC,MAAM,CACNZ,OAAO,CACPc,WAAW,CACXxB,QAAQ,CAAE8B,MAAM,CAACxC,IAAI,CAACU,QAAQ,CAAC,CAC/B4B,IACJ,CAAC,CAED7C,KAAK,CAACgD,IAAI,IAAAnC,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,eAAc8B,QAAQ,CAAC,CAC7D5B,IAAI,CAAC+B,QAAQ,EAAI,CACd;AACA1B,OAAO,CAACC,GAAG,CAACyB,QAAQ,CAAC7B,IAAI,CAAC,CAC1B8B,KAAK,CAAC,4BAA4B,CAAC,CACnCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC9B,CAAC,CAAC,CACDhC,KAAK,CAACiC,KAAK,EAAI,CACZ;AACA/B,OAAO,CAACC,GAAG,CAAC8B,KAAK,CAAC,CACtB,CAAC,CAAC,CAEN/B,OAAO,CAACC,GAAG,CAACsB,QAAQ,CAAC,CACrBd,SAAS,CAAC,CAAC,CACf,CAAC,CAMD,mBAEI5B,KAAA,QAAKmD,SAAS,CAAC,uBAAuB,CAAAxB,QAAA,eAC9B3B,KAAA,QAAKmD,SAAS,CAAC,gBAAgB,CAAAxB,QAAA,eAE3B3B,KAAA,QAAKmD,SAAS,CAAC,kBAAkB,CAAAxB,QAAA,eAC7B7B,IAAA,MAAGqD,SAAS,CAAC,oBAAoB,CAAAxB,QAAA,CAAC,OAAK,CAAG,CAAC,cAC3C7B,IAAA,UAAOsD,EAAE,CAAC,OAAO,CAACX,IAAI,CAAC,MAAM,CAACU,SAAS,CAAC,aAAa,CAACE,WAAW,CAAC,kBAAkB,CAAE,CAAC,EACtF,CAAC,cACNrD,KAAA,QAAKmD,SAAS,CAAC,mBAAmB,CAAAxB,QAAA,EAE7BrB,OAAO,eACJN,KAAA,QAAA2B,QAAA,eACJ7B,IAAA,MAAGqD,SAAS,CAAC,yBAAyB,CAAAxB,QAAA,CAAC,MAAI,CAAG,CAAC,cAC/C3B,KAAA,WAAQoD,EAAE,CAAC,MAAM,CAACD,SAAS,CAAC,eAAe,CAACE,WAAW,CAAC,MAAM,CAAA1B,QAAA,eAC1D7B,IAAA,WAAQ2B,KAAK,CAAC,EAAE,CAAC6B,QAAQ,MAACC,QAAQ,MAACC,MAAM,MAAA7B,QAAA,CAAC,kBAAgB,CAAQ,CAAC,cACnE7B,IAAA,WAAQ2B,KAAK,CAAC,cAAc,CAAAE,QAAA,CAAC,cAAY,CAAQ,CAAC,cAClD7B,IAAA,WAAQ2B,KAAK,CAAC,SAAS,CAAAE,QAAA,CAAC,cAAY,CAAQ,CAAC,EACzC,CAAC,EACJ,CACJ,cAEL3B,KAAA,QAAA2B,QAAA,eACI7B,IAAA,MAAGqD,SAAS,CAAC,yBAAyB,CAAAxB,QAAA,CAAC,QAAM,CAAG,CAAC,cACjD3B,KAAA,WAAQoD,EAAE,CAAC,QAAQ,CAACD,SAAS,CAAC,eAAe,CAACE,WAAW,CAAC,QAAQ,CAAA1B,QAAA,eAC9D7B,IAAA,WAAQ2B,KAAK,CAAC,EAAE,CAAC6B,QAAQ,MAACC,QAAQ,MAACC,MAAM,MAAA7B,QAAA,CAAC,oBAAkB,CAAQ,CAAC,CACpEN,OAAO,EACJ,CAAC,EAAK,CAAC,EACd,CAAC,EACL,CAAC,cACVrB,KAAA,QAAKmD,SAAS,CAAC,mBAAmB,CAAAxB,QAAA,eAC9B7B,IAAA,MAAGqD,SAAS,CAAC,mBAAmB,CAAAxB,QAAA,CAAC,UAAQ,CAAG,CAAC,cAC7C7B,IAAA,aAAUsD,EAAE,CAAC,SAAS,CAACD,SAAS,CAAC,YAAY,CAACE,WAAW,CAAC,sBAAsB,CAAE,CAAC,cAEnFvD,IAAA,MAAGqD,SAAS,CAAC,mBAAmB,CAAAxB,QAAA,CAAC,8DAA0D,CAAG,CAAC,cAC/F7B,IAAA,QAAKqD,SAAS,CAAC,uBAAuB,CAAAxB,QAAA,cAClC7B,IAAA,UAAOsD,EAAE,CAAC,QAAQ,CAACX,IAAI,CAAC,MAAM,CAACU,SAAS,CAAC,aAAa,CAACE,WAAW,CAAC,mBAAmB,CAAE,CAAC,CACxF,CAAC,cACNvD,IAAA,WAAQ2D,OAAO,CAAE1B,YAAa,CAACoB,SAAS,CAAC,aAAa,CAAAxB,QAAA,CAAC,MAAI,CAAQ,CAAC,EACnE,CAAC,EACL,CAAC,CAEd,CAAC,CAED,cAAe,CAAA1B,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}